<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
		"-//Hibernate/Hibernate Mapping DTD 3.0//EN"
		"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping package="org.flexpay.common.persistence">

	<query name="Process.readFull">
		select distinct pi
		from org.jbpm.graph.exe.ProcessInstance pi
		    left join fetch pi.processDefinition pd
		where pi.id=?
        order by pi.id desc
	</query>

	<query name="Process.findAllProcessNames">
		select distinct pd.name
		from org.jbpm.graph.def.ProcessDefinition pd
        order by pd.id desc
	</query>

	<query name="Process.listForDelete">
	<![CDATA[
		select pi.id from org.jbpm.graph.exe.ProcessInstance pi
		where (pi.start>=? and pi.end<=? and (pi.processDefinition.name=? or 1=?))
	]]>
	</query>

	<query name="Process.listForDelete.count">
	<![CDATA[
		select count(pi.id) from org.jbpm.graph.exe.ProcessInstance pi
		where (pi.start>=? and pi.end<=? and (pi.processDefinition.name=? or 1=?))
	]]>
	</query>

</hibernate-mapping>
