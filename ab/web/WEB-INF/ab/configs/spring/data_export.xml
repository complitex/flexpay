<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:p="http://www.springframework.org/schema/p" xmlns:context="http://www.springframework.org/schema/context"
	   xsi:schemaLocation="
		   http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
		   http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd">

	<bean id="dataExportDao"
		  class="org.flexpay.ab.dao.importexport.impl.HarkovCenterNachisleniyDataSource"
		  p:jdbcTemplate-ref="dataExportJdbcTemplate" />

	<bean id="allObjectsDao"
		  class="org.flexpay.ab.service.importexport.impl.AllObjectsDao"
		  p:hibernateTemplate-ref="hibernateTemplate" />

	<!-- Data sources -->
	<bean id="districtJdbcDataSource"
		  class="org.flexpay.ab.dao.importexport.DistrictJdbcDataSource"
		  p:source-ref="dataExportDao" />

	<bean id="streetTypeJdbcDataSource"
		  class="org.flexpay.ab.dao.importexport.StreetTypeJdbcDataSource"
		  p:source-ref="dataExportDao" />

	<bean id="streetJdbcDataSource"
		  class="org.flexpay.ab.dao.importexport.StreetJdbcDataSource"
		  p:source-ref="dataExportDao" />

	<bean id="buildingsJdbcDataSource"
		  class="org.flexpay.ab.dao.importexport.BuildingsJdbcDataSource"
		  p:source-ref="dataExportDao" />

	<bean id="apartmentJdbcDataSource"
		  class="org.flexpay.ab.dao.importexport.ApartmentJdbcDataSource"
		  p:source-ref="dataExportDao" />

	<bean id="personJdbcDataSource"
		  class="org.flexpay.ab.dao.importexport.PersonJdbcDataSource"
		  p:source-ref="dataExportDao" />

	<!-- Data converters -->
	<bean id="districtDataConverter"
		  class="org.flexpay.ab.service.importexport.RawDistrictDataConverter" />

	<bean id="streetTypeDataConverter"
		  class="org.flexpay.ab.service.importexport.RawStreetTypeDataConverter" />

	<bean id="streetDataConverter"
		  class="org.flexpay.ab.service.importexport.RawStreetDataConverter" />

	<bean id="buildingsDataConverter"
		  class="org.flexpay.ab.service.importexport.RawBuildingsDataConverter"
		  p:factory-ref="objectsFactory" />

	<bean id="apartmentDataConverter"
		  class="org.flexpay.ab.service.importexport.RawApartmentDataConverter"
		  p:buildingService-ref="buildingService"
		  p:factory-ref="objectsFactory" />

	<bean id="personDataConverter"
		  class="org.flexpay.ab.service.importexport.RawPersonDataConverter"
		  p:identityTypeService-ref="identityTypeService" />

	<bean id="classToTypeRegistryAb"
		  autowire-candidate="false"
		  class="org.flexpay.ab.service.importexport.impl.ClassToTypeRegistryAb" />

	<bean id="classToTypeRegistryFactoryAb"
		  depends-on="classToTypeRegistryFactory"
		  class="org.flexpay.common.service.importexport.impl.ClassToTypeRegistryFactory">
		<property name="registry">
			<bean class="org.flexpay.common.service.importexport.impl.CompositeClassToTypeRegistry">
				<property name="registries">
					<list>
						<ref bean="classToTypeRegistryAb" />
						<ref bean="classToTypeRegistryCommon" />
					</list>
				</property>
			</bean>
		</property>
	</bean>

	<!-- Import-Export services -->
	<bean id="importServiceAb" class="org.flexpay.ab.service.importexport.ImportServiceImpl">
		<property name="districtDataSource" ref="districtJdbcDataSource" />
		<property name="districtDataConverter" ref="districtDataConverter" />
		<property name="streetTypeDataSource" ref="streetTypeJdbcDataSource" />
		<property name="buildingsDataSource" ref="buildingsJdbcDataSource" />
		<property name="apartmentDataSource" ref="apartmentJdbcDataSource" />
		<property name="personDataSource" ref="personJdbcDataSource" />
		<property name="streetTypeDataConverter" ref="streetTypeDataConverter" />
		<property name="streetDataSource" ref="streetJdbcDataSource" />
		<property name="streetDataConverter" ref="streetDataConverter" />
		<property name="buildingsDataConverter" ref="buildingsDataConverter" />
		<property name="apartmentDataConverter" ref="apartmentDataConverter" />
		<property name="personDataConverter" ref="personDataConverter" />
		<property name="correctionsService" ref="correctionsService" />
		<property name="districtService" ref="districtService" />
		<property name="streetTypeService" ref="streetTypeService" />
		<property name="streetService" ref="streetService" />
		<property name="buildingService" ref="buildingService" />
		<property name="apartmentService" ref="apartmentService" />
		<property name="personService" ref="personService" />
		<property name="allObjectsDao" ref="allObjectsDao" />
		<property name="errorsSupport" ref="importErrorSupport" />
		<property name="importErrorService" ref="importErrorService" />
		<property name="registry" ref="classToTypeRegistry" />
	</bean>

</beans>
