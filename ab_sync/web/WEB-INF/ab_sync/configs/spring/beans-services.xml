<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:p="http://www.springframework.org/schema/p" xmlns:context="http://www.springframework.org/schema/context"
	   xsi:schemaLocation="
		   http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
		   http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd">

	<bean id="townProcessor"
		  class="org.flexpay.ab.service.impl.TownProcessor"
		  p:townService-ref="townService" />

	<bean id="streetTypeProcessor"
		  class="org.flexpay.ab.service.impl.StreetTypeProcessor"
		  p:streetTypeService-ref="streetTypeService" />

	<bean id="streetProcessor"
		  class="org.flexpay.ab.service.impl.StreetProcessor"
		  p:streetService-ref="streetService"
		  p:streetTypeService-ref="streetTypeService" />

	<bean id="districtProcessor"
		  class="org.flexpay.ab.service.impl.DistrictProcessor"
		  p:districtService-ref="districtService" />

	<bean id="buildingProcessor"
		  class="org.flexpay.ab.service.impl.BuildingProcessor"
		  p:streetDao-ref="streetDao"
		  p:districtDao-ref="districtDao"
		  p:buildingDao-ref="buildingDao"
		  p:buildingsDao-ref="buildingsDao"
		  p:buildingService-ref="buildingService"
		  p:factory-ref="objectsFactory" />

	<bean id="apartmentProcessor"
		  class="org.flexpay.ab.service.impl.ApartmentProcessor"
		  p:buildingsDao-ref="buildingsDao"
		  p:apartmentService-ref="apartmentService"
		  p:factory-ref="objectsFactory" />

	<bean id="personProcessor" class="org.flexpay.ab.service.impl.PersonProcessor">
		<property name="personService" ref="personService" />
		<property name="identityTypeService" ref="identityTypeService" />
	</bean>


	<bean id="abSyncService" class="org.flexpay.ab.service.impl.SyncServiceImpl">
		<property name="correctionsService" ref="correctionsService" />
		<property name="historyDao" ref="historyDaoJdbc" />
		<property name="townProcessor" ref="townProcessor" />
		<property name="buildingProcessor" ref="buildingProcessor" />
		<property name="apartmentProcessor" ref="apartmentProcessor" />
		<property name="streetProcessor" ref="streetProcessor" />
		<property name="districtProcessor" ref="districtProcessor" />
		<property name="streetTypeProcessor" ref="streetTypeProcessor" />
		<property name="personProcessor" ref="personProcessor" />
		<property name="lockManager" ref="lockManager" />
		<property name="sd">
			<bean class="org.flexpay.common.persistence.DataSourceDescription">
				<constructor-arg index="0" value="${ab.sync.data.source.id}" type="java.lang.Long" />
			</bean>
		</property>
	</bean>

	<bean id="historyDumpService" class="org.flexpay.ab.service.impl.HistoryDumpServiceImpl">
		<property name="historyDao" ref="historyDaoJdbc" />
		<property name="historySourceDao" ref="historySourceDao" />
		<property name="updateConfigDao" ref="syncConfigDaoJdbc" />
		<property name="lockManager" ref="lockManager" />
	</bean>

</beans>
