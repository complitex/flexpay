<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:p="http://www.springframework.org/schema/p" xmlns:context="http://www.springframework.org/schema/context"
	   xsi:schemaLocation="
		   http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
		   http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd">

	<bean id="registryFileService"
		  class="org.flexpay.eirc.service.imp.RegistryFileServiceImpl"
		  p:registryDao-ref="spRegistryDao"
		  p:registryRecordDao-ref="spRegistryRecordDao"
		  p:registryRecordDaoExt-ref="spRegistryRecordDaoExt"
		  p:registryFileDaoExt-ref="registryFileDaoExt" />

	<bean id="registryService"
		  class="org.flexpay.eirc.service.imp.RegistryServiceImpl"
		  p:spRegistryDao-ref="spRegistryDao"
		  p:registryDaoExt-ref="spRegistryDaoExt"
		  p:spRegistryRecordService-ref="registryRecordService"
		  p:organizationDao-ref="organizationDao"
		  p:registryContainerDao-ref="registryContainerDao"
			/>

	<bean id="registryRecordService"
		  class="org.flexpay.eirc.service.imp.RegistryRecordServiceImpl"
		  p:spRegistryRecordDao-ref="spRegistryRecordDao"
		  p:spRegistryRecordDaoExt-ref="spRegistryRecordDaoExt"
		  p:recordContainerDao-ref="registryRecordContainerDao"
		  p:workflowManager-ref="registryRecordWorkflowManager"
			/>

	<bean id="registryTypeService"
		  class="org.flexpay.eirc.service.imp.RegistryTypeServiceImpl"
		  p:spRegistryTypeDao-ref="spRegistryTypeDao" />

	<bean id="registryWorkflowManager"
		  class="org.flexpay.eirc.persistence.workflow.RegistryWorkflowManager"
		  p:registryDao-ref="spRegistryDao"
		  p:registryDaoExt-ref="spRegistryDaoExt"
		  p:statusService-ref="spRegistryStatusService" />

	<bean id="registryRecordWorkflowManager"
		  class="org.flexpay.eirc.persistence.workflow.RegistryRecordWorkflowManager"
		  p:errorDao-ref="importErrorDao"
		  p:recordDao-ref="spRegistryRecordDao"
		  p:statusService-ref="registryRecordStatusService"
		  p:registryWorkflowManager-ref="registryWorkflowManager" />

	<bean id="registryFileParser"
		  class="org.flexpay.eirc.sp.RegistryFileParser"
		  p:consumerService-ref="consumerService"
		  p:registryService-ref="registryService"
		  p:registryArchiveStatusService-ref="registryArchiveStatusService"
		  p:registryRecordService-ref="registryRecordService"
		  p:registryTypeService-ref="registryTypeService"
		  p:organizationService-ref="organizationService"
		  p:providerService-ref="serviceProviderService"
		  p:registryWorkflowManager-ref="registryWorkflowManager"
		  p:recordWorkflowManager-ref="registryRecordWorkflowManager"
		  p:sessionUtils-ref="sessionUtils"
		  p:propertiesFactory-ref="propertiesFactory" />

	<bean id="mbRegistryFileValidator"
		  class="org.flexpay.eirc.sp.MbRegistryFileValidator"
			/>

	<bean id="mbRegistryFileParser"
		  class="org.flexpay.eirc.sp.MbRegistryFileParser"
		  p:registryTypeService-ref="registryTypeService"
		  p:serviceProviderService-ref="serviceProviderService"
		  p:consumerService-ref="consumerService"
		  p:registryService-ref="registryService"
		  p:registryRecordService-ref="registryRecordService"
		  p:spRegistryStatusService-ref="spRegistryStatusService"
		  p:spRegistryRecordStatusService-ref="registryRecordStatusService"
		  p:registryArchiveStatusService-ref="registryArchiveStatusService"
		  p:propertiesFactory-ref="eircPropertiesFactory"
		  p:validator-ref="mbRegistryFileValidator"
			/>

	<bean id="eircAccountService"
		  class="org.flexpay.eirc.service.imp.EircAccountServiceImpl"
		  p:personService-ref="personService"
		  p:sequenceService-ref="sequenceService"
		  p:eircAccountDao-ref="eircAccountDao"
		  p:eircAccountDaoExt-ref="eircAccountDaoExt" />

	<bean id="serviceOperationsFactory"
		  class="org.flexpay.eirc.persistence.exchange.ServiceOperationsFactory"
		  p:conditionsFactory-ref="conditionsFactory"
		  p:importErrorService-ref="importErrorServiceEirc"
		  p:registry-ref="typeRegistryEirc"
		  p:errorsSupport-ref="importErrorSupport"
		  p:correctionsService-ref="correctionsServiceEirc"
		  p:registryRecordDao-ref="spRegistryRecordDao"
		  p:spService-ref="spService"
		  p:spFileService-ref="registryFileService"
		  p:quittanceService-ref="quittanceService"
		  p:organizationService-ref="organizationService"
		  p:serviceProviderService-ref="serviceProviderService"
		  p:reportPeriodService-ref="reportPeriodService"
		  p:consumerService-ref="consumerService"
		  p:consumerInfoService-ref="consumerInfoService"
		  p:importUtil-ref="eircImportUtil"
		  p:accountService-ref="eircAccountService" />

	<bean id="consumerServiceTarget"
		  autowire-candidate="false"
		  class="org.flexpay.eirc.service.imp.ConsumerServiceImpl"
		  p:serviceDao-ref="serviceDao"
		  p:consumerDao-ref="consumerDao"
		  p:consumerDaoExt-ref="consumerDaoExt" />

	<bean id="consumerInfoService"
		  class="org.flexpay.eirc.service.imp.ConsumerInfoServiceImpl"
		  p:consumerInfoDao-ref="consumerInfoDao" />

	<bean id="quittancePaymentStatusServiceTarget"
		  autowire-candidate="false"
		  class="org.flexpay.eirc.service.imp.QuittancePaymentStatusServiceImpl"
		  p:statusDao-ref="quittancePaymentStatusDao" />

	<bean id="quittanceService"
		  class="org.flexpay.eirc.service.imp.QuittanceServiceImpl"
		  p:quittanceNumberService-ref="quittanceNumberService"
		  p:quittanceDetailsDao-ref="quittanceDetailsDao"
		  p:quittanceDaoExt-ref="quittanceDaoExt"
		  p:quittanceDao-ref="quittanceDao" />

	<bean id="quittancePacketService"
		  class="org.flexpay.eirc.service.imp.QuittancePacketServiceImpl"
		  p:quittancePacketDaoExt-ref="quittancePacketDaoExt"
		  p:quittancePacketDao-ref="quittancePacketDao"
		  p:quittancePaymentDao-ref="quittancePaymentDao" />

	<bean id="quittancePaymentService"
		  class="org.flexpay.eirc.service.imp.QuittancePaymentServiceImpl"
		  p:organizationService-ref="organizationService"
		  p:quittancePaymentDao-ref="quittancePaymentDao"
		  p:documentTypeService-ref="documentTypeService"
		  p:documentStatusService-ref="documentStatusService"
		  p:operationService-ref="operationService"
		  p:operationLevelService-ref="operationLevelService"
		  p:operationStatusService-ref="operationStatusService"
		  p:operationTypeService-ref="operationTypeService"
		  p:spService-ref="spService" />

	<bean id="eircPaymentPointService"
		  class="org.flexpay.eirc.service.imp.PaymentPointServiceImpl"
		  p:paymentPointDao-ref="paymentPointDao" />

	<bean id="eircServiceOrganizationService" parent="serviceOrganizationService"
		  class="org.flexpay.eirc.service.imp.ServiceOrganizationServiceImpl"
		  p:servedBuildingDao-ref="servedBuildingDao" />

	<bean id="quittanceNumberService"
		  class="org.flexpay.eirc.service.imp.QuittanceNumberServiceImpl" />

	<bean id="reportPeriodService"
		  class="org.flexpay.eirc.service.imp.ReportPeriodServiceImpl" />

	<bean id="quittanceInfoBuilder"
		  class="org.flexpay.eirc.service.exchange.QuittanceInfoBuilder"
		  p:apartmentService-ref="apartmentService"
		  p:masterIndexService-ref="masterIndexService"
		  p:quittanceNumberService-ref="quittanceNumberService"
		  p:quittanceService-ref="quittanceService"
		  p:quittancePaymentService-ref="quittancePaymentService" />

	<bean id="eircQuittanceDetailsFinder"
		  class="org.flexpay.eirc.service.exchange.QuittanceDetailsFinderImpl"
		  p:correctionsService-ref="correctionsServiceEirc"
		  p:masterIndexService-ref="masterIndexService"
		  p:quittanceService-ref="quittanceService"
		  p:accountService-ref="eircAccountService"
		  p:quittanceInfoBuilder-ref="quittanceInfoBuilder" />

	<bean id="serviceProviderFileProcessorTx"
		  class="org.flexpay.eirc.service.exchange.ServiceProviderFileProcessorTx"
		  p:recordWorkflowManager-ref="registryRecordWorkflowManager"
		  p:serviceOperationsFactory-ref="serviceOperationsFactory" />

	<bean id="registryProcessor"
		  class="org.flexpay.eirc.service.exchange.ServiceProviderFileProcessor"
		  p:processorTx-ref="serviceProviderFileProcessorTx"
		  p:serviceOperationsFactory-ref="serviceOperationsFactory"
		  p:registryFileService-ref="registryFileService"
		  p:registryService-ref="registryService"
		  p:importService-ref="importServiceEirc"
		  p:rawConsumersDataSource-ref="consumersDataSource"
		  p:errorsSupport-ref="importErrorSupport"
		  p:registryRecordService-ref="registryRecordService"
		  p:classToTypeRegistry-ref="typeRegistryEirc"
		  p:recordWorkflowManager-ref="registryRecordWorkflowManager"
		  p:registryWorkflowManager-ref="registryWorkflowManager"
		  p:serviceProviderService-ref="serviceProviderService" />

	<bean id="spRegistryStatusService"
		  class="org.flexpay.eirc.service.imp.SpRegistryStatusServiceImpl"
		  p:spRegistryStatusDao-ref="spRegistryStatusDao" />

	<bean id="registryArchiveStatusServiceTarget"
		  autowire-candidate="false"
		  class="org.flexpay.eirc.service.imp.RegistryArchiveStatusServiceImpl"
		  p:registryArchiveStatusDao-ref="registryArchiveStatusDao" />

	<bean id="registryRecordStatusService" class="org.flexpay.eirc.service.imp.SpRegistryRecordStatusServiceImpl"
		  p:spRegistryRecordStatusDao-ref="spRegistryRecordStatusDao" />

	<bean id="processManagerEirc" parent="processManager" autowire-candidate="false">
		<property name="definitionPaths">
			<list merge="true">
				<value>WEB-INF/eirc/process</value>
			</list>
		</property>
		<property name="lyfecycleVoters">
			<list merge="true">
				<bean class="org.flexpay.eirc.process.quittance.QuittanceJobVoter"
					  p:processHelper-ref="processHelper" />
			</list>
		</property>
	</bean>

	<bean id="eircPropertiesFactory" depends-on="propertiesFactory" autowire-candidate="false"
		  factory-bean="propertiesFactoryHolder" factory-method="getFactory">
		<property name="factory">
			<bean class="org.flexpay.eirc.persistence.EircPropertiesFactory" autowire-candidate="false" />
		</property>
	</bean>

</beans>
